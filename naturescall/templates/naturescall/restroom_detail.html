{% extends "naturescall/base.html" %}

{% block content %}
    <div class="container-fluid">
        <img class="img-fluid" src={{res.yelp_data.image_url}} alt="Card image cap" style= "width:100%; height:15vw; object-fit: cover;">
    </div>

    <div class="container">
        <div class="d-flex justify-content-center">

            {% if messages %}
            <div class="alert alert-warning alert-dismissible fade show mt-3" role="alert">
                <ul class="messages">
                    {% for message in messages %}
                        {{ message }}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                        </button>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            <div class="card">
                <div class="card-body">
                    <h2 class="card-title">
                        {{res.yelp_data.name}}
                        {% if res.yelp_data.accessible %}
                            <span class="badge badge-secondary bg-success text-white">Accessible</span>
                        {% endif %}
                        {% if res.yelp_data.family_friendly  %}
                            <span class="badge badge-secondary bg-primary text-white" >Family Friendly</span>
                        {% endif %}
                        {% if res.yelp_data.transaction_not_required  %}
                            <span class="badge badge-secondary bg-warning text-dark">Transaction Not Required</span>
                        {% endif %}
                    </h2>
                    <h4 class="card-text"> Address: {{res.addr}}</h4>
                    <h4 class="card-text">Rating: {{res.yelp_data.rating}} </h4>
                    <h4 class="card-text">Description: {{res.desc}} </h4>
                    <a href="{% url 'naturescall:rate_restroom' res.yelp_data.db_id %}" class="btn btn-primary">Rate Now!</a>
                    {% if show_claim %}
                        <a href="{% url 'naturescall:claim_restroom' res.yelp_data.db_id %}" class="btn btn-primary">Claim This Restroom!</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="col d-flex justify-content-center">
        <!-- map card -->
        <iframe
                width="600"
                height="450"
                style="border:0"
                loading="lazy"
                allowfullscreen
                src="https://www.google.com/maps/embed/v1/directions?key={{map_key}}
             &origin={{request.session.search_location}}
             &destination= {{res.addr}}
             &mode=walking">
        </iframe>
        <!-- end of map -->
    </div>



    <div class="container">
        <div class="card">
            <div class="card-body">
                <h2 class="card-title">Ratings</h2>
                {% for rating in ratings %}
                    <h4>{{rating.user_id}}</h4>
                    <p>
                        Rating: {{rating.rating}}<br>
                        Headline: {{rating.headline}}<br>
                        Comment: {{rating.comment}}<br>
                    </p>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}
